{% extends "layout.html" %}
{% block content %}

<body>
    {% if matches %}
        {% for match in matches %}
            {% for court in match.courts %}
                <ul class="court">
                    <li class="court-title">Court {{ court.court_number }}</li>
                    {% set players = court.court_players | sort(attribute='id') %}
                    <li class="team">
                        <div class="team-info">
                            <strong>Team 1:</strong>
                            {{ players[0].player.name if players|length > 0 else '—' }} &
                            {{ players[1].player.name if players|length > 1 else '—' }}
                        </div>
                        <div class="declare-button">
                            {% if court.winning_team is none %}
                                <form method="POST" action="{{ url_for('set_winner', court_id=court.id, team_number=1) }}">
                                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                                    <button type="submit" class="winner-btn">Declare Winner</button>
                                </form>
                            {% elif court.winning_team == 1 %}
                                <span class="winner">Winner</span>
                            {% endif %}
                        </div>
                    </li>

                    <li class="team">
                        <div class="team-info">
                            <strong>Team 2:</strong>
                            {{ players[2].player.name if players|length > 2 else '—' }} &
                            {{ players[3].player.name if players|length > 3 else '—' }}
                        </div>
                        <div class="declare-button">
                            {% if court.winning_team is none %}
                                <form method="POST" action="{{ url_for('set_winner', court_id=court.id, team_number=2) }}">
                                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                                    <button type="submit" class="winner-btn">Declare Winner</button>
                                </form>
                            {% elif court.winning_team == 2 %}
                                <span class="winner">Winner</span>
                            {% endif %}
                        </div>
                    </li>
                </ul>
            {% endfor %}
        {% endfor %}
        <div class="resting-players">
            <h2>Resting Players</h2>
            {% if resting_players %}
                <ul>
                    {% for player in resting_players %}
                        <li>{{ player.name }}</li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>No players are resting.</p>
            {% endif %}

    {% else %}
        <p>No matches have been generated yet.</p>
    {% endif %}

    <br>
    <a href="{{ url_for('draft') }}" class="btn">Back to Draft</a>
</body>
{% endblock %}
